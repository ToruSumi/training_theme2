[
    {
        "id": "9e5ecd4cf9f59b1c",
        "type": "tab",
        "label": "TeamsÊäïÁ®øÈÉ®ÔºàÂ¢®Ôºâ",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "5e91b4b52f96d060",
        "type": "inject",
        "z": "9e5ecd4cf9f59b1c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 180,
        "wires": [
            [
                "ec64e4aa24d0e6c4"
            ]
        ]
    },
    {
        "id": "e94a62b33d37f2a3",
        "type": "template",
        "z": "9e5ecd4cf9f59b1c",
        "name": "make adaptive card for teams",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\n    \"type\": \"message\",\n    \"attachments\": [\n        {\n            \"contentType\": \"application/vnd.microsoft.card.adaptive\",\n            \"contentUrl\": null,\n            \"content\": {\n                \"type\": \"AdaptiveCard\",\n                \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n                \"version\": \"1.5\",\n                \"body\": [\n                    {\n                        \"type\": \"ColumnSet\",\n                        \"columns\": [\n                            {\n                                \"type\": \"Column\",\n                                \"width\": \"auto\",\n                                \"items\": [\n                                    {\n                                        \"type\": \"Image\",\n                                        \"url\": \"https://icon-library.com/images/quiz-icon/quiz-icon-2.jpg\",\n                                        \"size\": \"Medium\"\n                                    }\n                                ]\n                            },\n                            {\n                                \"type\": \"Column\",\n                                \"width\": \"auto\",\n                                \"items\": [\n                                    {\n                                        \"type\": \"TextBlock\",\n                                        \"text\": \"{{flow.title}}\",\n                                        \"wrap\": true,\n                                        \"style\": \"heading\",\n                                        \"size\": \"ExtraLarge\"\n                                    }\n                                ],\n                                \"horizontalAlignment\": \"Center\",\n                                \"verticalContentAlignment\": \"Center\"\n                            }\n                        ]\n                    },\n                    {\n                        \"type\": \"TextBlock\",\n                        \"text\": \"„ÇØ„Ç§„Ç∫„ÅåÁµÇ‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ\",\n                        \"wrap\": true\n                    },\n                    {\n                        \"type\": \"RichTextBlock\",\n                        \"inlines\": [\n                            {\n                                \"type\": \"TextRun\",\n                                \"text\": \"ÂÑ™ÂãùËÄÖ„ÅØ\\n‚ú® \"\n                            },\n                            {\n                                \"type\": \"TextRun\",\n                                \"text\": \"{{flow.rank1}}\",\n                                \"size\": \"Large\"\n                            },\n                            {\n                                \"type\": \"TextRun\",\n                                \"text\": \" „Åï„Çì‚ú®„Åß„ÅôÔºÅÔºÅ\"\n                            }\n                        ]\n                    },\n                    {\n                        \"type\": \"TextBlock\",\n                        \"text\": \"„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô!üéâ\",\n                        \"wrap\": true\n                    },\n                    {\n                        \"type\": \"Table\",\n                        \"gridStyle\": \"accent\",\n                        \"columns\": [\n                            {\n                                \"width\": 1,\n                                \"horizontalCellContentAlignment\": \"right\"\n                            },\n                            {\n                                \"width\": 3,\n                                \"horizontalCellContentAlignment\": \"center\"\n                            },\n                            {\n                                \"width\": 3,\n                                \"horizontalCellContentAlignment\": \"center\"\n                            }\n                        ],\n                        \"rows\": [\n                            {\n                                \"type\": \"TableRow\",\n                                \"cells\": [\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"È†Ü‰Ωç\",\n                                                \"horizontalAlignment\": \"Center\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"Ê∞èÂêç\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"Ë™§Â∑Æ\"\n                                            }\n                                        ]\n                                    }\n                                ],\n                                \"style\": \"accent\"\n                            },\n                            {\n                                \"type\": \"TableRow\",\n                                \"cells\": [\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"üëë1\",\n                                                \"weight\": \"Bolder\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"{{flow.rank1}}„Åï„Çì\",\n                                                \"weight\": \"Bolder\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"{{flow.rank1_diff}}\",\n                                                \"weight\": \"Bolder\"\n                                            }\n                                        ]\n                                    }\n                                ],\n                                \"style\": \"good\"\n                            },\n                            {\n                                \"type\": \"TableRow\",\n                                \"cells\": [\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"2\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"{{flow.rank2}}„Åï„Çì\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"{{flow.rank2_diff}}\",\n                                                \"weight\": \"Bolder\"\n                                            }\n                                        ]\n                                    }\n                                ],\n                                \"style\": \"default\"\n                            },\n                            {\n                                \"type\": \"TableRow\",\n                                \"cells\": [\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"3\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"{{flow.rank3}}„Åï„Çì\"\n                                            }\n                                        ]\n                                    },\n                                    {\n                                        \"type\": \"TableCell\",\n                                        \"items\": [\n                                            {\n                                                \"type\": \"TextBlock\",\n                                                \"text\": \"{{flow.rank3_diff}}\",\n                                                \"weight\": \"Bolder\"\n                                            }\n                                        ]\n                                    }\n                                ]\n                            }\n                        ],\n                        \"spacing\": \"Medium\",\n                        \"separator\": true,\n                        \"horizontalAlignment\": \"Center\"\n                    }\n                ],\n                \"actions\": [\n                    {\n                        \"type\": \"Action.OpenUrl\",\n                        \"title\": \"URL„ÇíÈñã„Åè\",\n                        \"url\": \"https://iot23-group-g.gcp.pgtls.net/ui/\"\n                    }\n                ]\n            }\n        }\n    ]\n}",
        "output": "json",
        "x": 730,
        "y": 120,
        "wires": [
            [
                "f30b57ff522c0cd6"
            ]
        ]
    },
    {
        "id": "ec64e4aa24d0e6c4",
        "type": "change",
        "z": "9e5ecd4cf9f59b1c",
        "name": "set values",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "flow",
                "to": "Weather Heroes",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "rank1",
                "pt": "flow",
                "to": "A",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "rank2",
                "pt": "flow",
                "to": "B",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "rank3",
                "pt": "flow",
                "to": "C",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "rank1_diff",
                "pt": "flow",
                "to": "0.2",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "rank2_diff",
                "pt": "flow",
                "to": "0.6",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "rank3_diff",
                "pt": "flow",
                "to": "1.2",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 180,
        "wires": [
            [
                "e94a62b33d37f2a3"
            ]
        ]
    },
    {
        "id": "f30b57ff522c0cd6",
        "type": "http request",
        "z": "9e5ecd4cf9f59b1c",
        "name": "POST message to teams",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "Please fill webhook url",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1050,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "c0dbc5b9d9bb1930",
        "type": "comment",
        "z": "9e5ecd4cf9f59b1c",
        "name": "Main flow",
        "info": "Template‰ΩúÊàê‰ª•Èôç„Åå„É°„Ç§„É≥Âá¶ÁêÜ\n\n1. link in „ÅßÂøÖË¶Å„Å™ÊÉÖÂ†±„ÇíÂèó„ÅëÂèñ„Çã\n2. Âèó„ÅëÂèñ„Å£„ÅüÊÉÖÂ†±„Çí‰ΩøÁî®„Åó„Å¶Adaptive card„Çí‰ΩúÊàê\n3. TeamsÊäïÁ®ø„Åô„Çã",
        "x": 340,
        "y": 80,
        "wires": []
    },
    {
        "id": "d5dd72dd4780e63e",
        "type": "link in",
        "z": "9e5ecd4cf9f59b1c",
        "name": "request to teams",
        "links": [
            "f26ab6621ef13b3b"
        ],
        "x": 305,
        "y": 120,
        "wires": [
            [
                "2ac074ec91a3c4bf"
            ]
        ]
    },
    {
        "id": "8748d30ef0bb5c22",
        "type": "comment",
        "z": "9e5ecd4cf9f59b1c",
        "name": "ÂøÖË¶Å„Å™ÊÉÖÂ†±",
        "info": "# ÂêÑ„É¶„Éº„Ç∂„Éº„ÅÆÂêçÂâç„Å®È†Ü‰Ωç\n- rank1\n- rank2\n- rank3\n\n# „É¶„Éº„Ç∂„Éº„Åî„Å®„ÅÆ‰∏çÂø´ÊåáÊï∞Ë™§Â∑Æ\n- rank1_diff\n- rank2_diff\n- rank3_diff\n\nlink in„Åã„Çâ„Å©„ÅÆ„Çà„ÅÜ„Å´Âèó„Åë‰ªò„Åë„Çã„ÅãÔºüÔºà„ÇÇ„Åó„Åè„ÅØ„Å©„ÅÆ„Çà„ÅÜ„Å´ÈÄÅ„Å£„Å¶„ÇÇ„Çâ„ÅÜ„ÅãÔºüÔºâ",
        "x": 660,
        "y": 80,
        "wires": [],
        "icon": "node-red/alert.svg"
    },
    {
        "id": "9685ab065a5806a1",
        "type": "comment",
        "z": "9e5ecd4cf9f59b1c",
        "name": "For debug",
        "info": "ÊâãÂãï„ÅßÂãï„Åã„ÅôÁî®",
        "x": 160,
        "y": 140,
        "wires": [],
        "icon": "node-red/debug.svg"
    },
    {
        "id": "2ac074ec91a3c4bf",
        "type": "change",
        "z": "9e5ecd4cf9f59b1c",
        "name": "set values",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "flow",
                "to": "Weather Heroes",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "rank1",
                "pt": "flow",
                "to": "rank1",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rank2",
                "pt": "flow",
                "to": "rank2",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rank3",
                "pt": "flow",
                "to": "rank3",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rank1_diff",
                "pt": "flow",
                "to": "rank1_diff",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rank2_diff",
                "pt": "flow",
                "to": "rank2_diff",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rank3_diff",
                "pt": "flow",
                "to": "rank3_diff",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 120,
        "wires": [
            [
                "e94a62b33d37f2a3"
            ]
        ]
    }
]
